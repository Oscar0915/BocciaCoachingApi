<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/BocciaCoaching/Models/DTO/User/AtlheteInfoSave.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/BocciaCoaching/Models/DTO/User/AtlheteInfoSave.cs" />
              <option name="originalContent" value="namespace BocciaCoaching.Models.DTO.User&#10;{&#10;    public class AtlheteInfoSave&#10;    {&#10;        public string? Dni { get; set; }&#10;&#10;        public string? FirstName { get; set; }&#10;&#10;        public string? LastName { get; set; }&#10;&#10;        public string? Email { get; set; }&#10;&#10;        public string? Password { get; set; }&#10;&#10;        public string? Address { get; set; }&#10;&#10;        public DateTime? Seniority { get; set; }&#10;&#10;        public bool Status { get; set; } = true;&#10;&#10;        public int CoachId { get; set; }&#10;     &#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="namespace BocciaCoaching.Models.DTO.User&#10;{&#10;    public class AtlheteInfoSave&#10;    {&#10;        public string? Dni { get; set; }&#10;&#10;        public string? FirstName { get; set; }&#10;&#10;        public string? LastName { get; set; }&#10;&#10;        public string? Email { get; set; }&#10;&#10;        public string? Password { get; set; }&#10;&#10;        public string? Address { get; set; }&#10;&#10;        public DateTime? Seniority { get; set; }&#10;&#10;        public bool Status { get; set; } = true;&#10;&#10;        public int CoachId { get; set; }&#10;&#10;        public int? TeamId { get; set; }&#10;     &#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/BocciaCoaching/Services/UserService.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/BocciaCoaching/Services/UserService.cs" />
              <option name="originalContent" value="using BocciaCoaching.Models.DTO.Auth;&#10;using BocciaCoaching.Models.DTO.General;&#10;using BocciaCoaching.Models.DTO.Notification;&#10;using BocciaCoaching.Models.DTO.User;&#10;using BocciaCoaching.Models.DTO.User.Atlhete;&#10;using BocciaCoaching.Repositories.Interfaces;&#10;using BocciaCoaching.Services.Interfaces;&#10;&#10;namespace BocciaCoaching.Services&#10;{&#10;    public class UserService: IUserService&#10;    {&#10;        private readonly IUserRepository _repository;&#10;        private readonly INotificationService _notificationService;&#10;&#10;        public UserService(IUserRepository repository, INotificationService notificationService)&#10;        {&#10;            _repository = repository;&#10;            _notificationService = notificationService;&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;bool&gt;&gt; AddUser(InfoUserRegisterDto userDto)&#10;        {&#10;            return await _repository.AddUser(userDto);&#10;        }&#10;&#10;        &#10;        public async Task&lt;ResponseContract&lt;IEnumerable&lt;InfoBasicUserDto&gt;&gt;&gt; GetAllAsync()&#10;        {&#10;            return await _repository.GetAllAsync();&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;InfoBasicUserDto&gt;&gt; GetByIdAsync(int id)&#10;        {&#10;            return await _repository.GetByIdAsync(id);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;LoginResponseDto&gt;&gt; Login(LoginRequestDto loginDto)&#10;        {&#10;            return await _repository.Login(loginDto);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;int&gt;&gt; RegistrarAtleta(AtlheteInfoSave atlheteInfoSave)&#10;        {&#10;            var result = await _repository.RegistrarAtleta(atlheteInfoSave);&#10;            &#10;            if (result.Success &amp;&amp; result.Data &gt; 0)&#10;            {&#10;                // Crear notificación para el atleta recién creado&#10;                var notificationMessage = new RequestCreateNotificationMessageDto&#10;                {&#10;                    NotificationTypeId = 1,&#10;                    ReceiverId = result.Data,&#10;                    SenderId = atlheteInfoSave.CoachId,&#10;                    Message = &quot;Bienvenido a Boccia Coaching. Tu contraseña por defecto es: boccia123. Por favor, cámbiala en tu primer inicio de sesión.&quot;,&#10;                    Status = true&#10;                };&#10;                &#10;                await _notificationService.CreateMessage(notificationMessage);&#10;            }&#10;            &#10;            return result;&#10;        }&#10;&#10;&#10;        public async Task&lt;ResponseContract&lt;ValidateEmailDto&gt;&gt; ValidateEmail(ValidateEmailDto email)&#10;        {&#10;            return await _repository.ValidateEmail(email);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;&gt; GetAthleteForName(SearchDataAthleteDto user)&#10;        {&#10;            var responseInfoAthletes = new List&lt;AtlheteInfo&gt;();&#10;            var dataAthletes= await _repository.GetUserForName(user);&#10;&#10;            if (dataAthletes.Success &amp;&amp; dataAthletes.Data != null &amp;&amp; dataAthletes.Data.Count &gt; 0)&#10;            {&#10;                foreach (var atlhete in dataAthletes.Data)&#10;                {&#10;                    AtlheteInfo atlheteInfo = new AtlheteInfo();&#10;                    atlheteInfo.AthleteId = atlhete.UserId;&#10;                    atlheteInfo.Name = atlhete.FirstName  + &quot; &quot; + atlhete.LastName;&#10;                    responseInfoAthletes.Add(atlheteInfo);&#10;                }&#10;                &#10;                return ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;.Ok(&#10;                    responseInfoAthletes,&#10;                    &quot;Búsqueda realizada satisfactoriamente&quot;&#10;                );&#10;            }&#10;            &#10;            return ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;.Fail(&quot;No se encontraron atletas&quot;);&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="using BocciaCoaching.Models.DTO.Auth;&#10;using BocciaCoaching.Models.DTO.General;&#10;using BocciaCoaching.Models.DTO.Notification;&#10;using BocciaCoaching.Models.DTO.User;&#10;using BocciaCoaching.Models.DTO.User.Atlhete;&#10;using BocciaCoaching.Repositories.Interfaces;&#10;using BocciaCoaching.Services.Interfaces;&#10;&#10;namespace BocciaCoaching.Services&#10;{&#10;    public class UserService: IUserService&#10;    {&#10;        private readonly IUserRepository _repository;&#10;        private readonly INotificationService _notificationService;&#10;&#10;        public UserService(IUserRepository repository, INotificationService notificationService)&#10;        {&#10;            _repository = repository;&#10;            _notificationService = notificationService;&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;bool&gt;&gt; AddUser(InfoUserRegisterDto userDto)&#10;        {&#10;            return await _repository.AddUser(userDto);&#10;        }&#10;&#10;        &#10;        public async Task&lt;ResponseContract&lt;IEnumerable&lt;InfoBasicUserDto&gt;&gt;&gt; GetAllAsync()&#10;        {&#10;            return await _repository.GetAllAsync();&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;InfoBasicUserDto&gt;&gt; GetByIdAsync(int id)&#10;        {&#10;            return await _repository.GetByIdAsync(id);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;LoginResponseDto&gt;&gt; Login(LoginRequestDto loginDto)&#10;        {&#10;            return await _repository.Login(loginDto);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;int&gt;&gt; RegistrarAtleta(AtlheteInfoSave atlheteInfoSave)&#10;        {&#10;            var result = await _repository.RegistrarAtleta(atlheteInfoSave);&#10;            &#10;            if (result.Success &amp;&amp; result.Data &gt; 0)&#10;            {&#10;                // Crear notificación de bienvenida para el atleta recién creado&#10;                var notificationMessage = new RequestCreateNotificationMessageDto&#10;                {&#10;                    NotificationTypeId = 1,&#10;                    ReceiverId = result.Data,&#10;                    SenderId = atlheteInfoSave.CoachId,&#10;                    Message = &quot;Bienvenido a Boccia Coaching. Tu contraseña por defecto es: boccia123. Por favor, cámbiala en tu primer inicio de sesión.&quot;,&#10;                    Status = true&#10;                };&#10;                &#10;                await _notificationService.CreateMessage(notificationMessage);&#10;&#10;                // Si se proporciona un TeamId, enviar invitación de equipo&#10;                if (atlheteInfoSave.TeamId.HasValue &amp;&amp; atlheteInfoSave.TeamId.Value &gt; 0)&#10;                {&#10;                    var teamInvitation = new RequestCreateNotificationMessageDto&#10;                    {&#10;                        NotificationTypeId = 2, // Tipo 2 para invitaciones de equipo&#10;                        ReceiverId = result.Data,&#10;                        SenderId = atlheteInfoSave.CoachId,&#10;                        Message = &quot;Has sido invitado a unirte al equipo. ¡Acepta la invitación para formar parte del equipo!&quot;,&#10;                        ReferenceId = atlheteInfoSave.TeamId.Value,&#10;                        Status = true&#10;                    };&#10;                    &#10;                    await _notificationService.CreateMessage(teamInvitation);&#10;                }&#10;            }&#10;            &#10;            return result;&#10;        }&#10;&#10;&#10;        public async Task&lt;ResponseContract&lt;ValidateEmailDto&gt;&gt; ValidateEmail(ValidateEmailDto email)&#10;        {&#10;            return await _repository.ValidateEmail(email);&#10;        }&#10;&#10;        public async Task&lt;ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;&gt; GetAthleteForName(SearchDataAthleteDto user)&#10;        {&#10;            var responseInfoAthletes = new List&lt;AtlheteInfo&gt;();&#10;            var dataAthletes= await _repository.GetUserForName(user);&#10;&#10;            if (dataAthletes.Success &amp;&amp; dataAthletes.Data != null &amp;&amp; dataAthletes.Data.Count &gt; 0)&#10;            {&#10;                foreach (var atlhete in dataAthletes.Data)&#10;                {&#10;                    AtlheteInfo atlheteInfo = new AtlheteInfo();&#10;                    atlheteInfo.AthleteId = atlhete.UserId;&#10;                    atlheteInfo.Name = atlhete.FirstName  + &quot; &quot; + atlhete.LastName;&#10;                    responseInfoAthletes.Add(atlheteInfo);&#10;                }&#10;                &#10;                return ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;.Ok(&#10;                    responseInfoAthletes,&#10;                    &quot;Búsqueda realizada satisfactoriamente&quot;&#10;                );&#10;            }&#10;            &#10;            return ResponseContract&lt;List&lt;AtlheteInfo&gt;&gt;.Fail(&quot;No se encontraron atletas&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>